Видеокарта — это аппаратное устройство, ответственное за обработку графической информации и её преобразование в изображение, которое отображается на экране. Она выполняет множество задач: от создания 2D- и 3D-графики до обработки видео и ускорения вычислений.

## Взаимодействие вычислительных блоков и памяти

1. **Передача данных.**  
    Центральный процессор (CPU) отправляет данные GPU через шину PCI Express. GPU получает команды и данные, включая геометрию объектов, текстуры и параметры освещения.
2. **Обработка в потоковых мультипроцессорах.**  
    Потоковые мультипроцессоры распределяют задачи между ядрами. Каждое ядро выполняет свою часть работы, используя локальную память для хранения временных данных.
3. **Работа с видеопамятью.**  
    GPU запрашивает данные из видеопамяти через контроллер. Если данные уже находятся в кэш-памяти, доступ к ним осуществляется быстрее, что снижает задержки.
4. **Обратная связь.**  
    После выполнения операций GPU возвращает данные в видеопамять или передаёт их на CPU. Итоговое изображение отправляется на экран через разъёмы HDMI или DisplayPort.


Архитектура GPU представляет собой многослойную систему, состоящую из вычислительных модулей, потоковых мультипроцессоров, контроллеров памяти и систем связи. GPU проектируются так, чтобы эффективно обрабатывать тысячи параллельных задач, что делает их особенно мощными для таких процессов, как рендеринг графики, трассировка лучей и машинное обучение.

1. **Потоковые мультипроцессоры (SM у NVIDIA, CU у AMD).**  
    GPU разделён на группы вычислительных блоков, называемые потоковыми мультипроцессорами (Streaming Multiprocessors, SM) в архитектуре NVIDIA или вычислительными блоками (Compute Units, CU) в архитектуре AMD. Каждый потоковый мультипроцессор включает в себя:
    - **CUDA-ядра (NVIDIA) или потоковые процессоры (AMD).** Это основные вычислительные элементы, которые выполняют параллельные операции, такие как умножение, сложение, логические операции и другие базовые вычисления.
    - **Тензорные ядра.** Используются для ускорения операций с матрицами, что важно для нейронных сетей и машинного обучения.
    - **Ядра RT.** Ускоряют трассировку лучей, расчёт теней, отражений и освещения.
2. **Глобальная память (VRAM).**  
    Видеопамять хранит данные, которые используются GPU для выполнения вычислений. Это могут быть текстуры, шейдеры, буферы кадра и данные о полигонах. GPU получает доступ к этой памяти через контроллер памяти. Чем больше объём и выше пропускная способность VRAM, тем больше данных может одновременно обрабатывать GPU.
3. **Кэш.**  
    Для оптимизации производительности используется многоуровневая система кэш-памяти. Она уменьшает задержки при доступе к данным и ускоряет выполнение задач.
4. **Системы связи.**  
    GPU включает шину, которая связывает ядра, модули памяти и другие компоненты. Современные архитектуры используют высокоскоростные интерфейсы, такие как NVLink, для увеличения скорости передачи данных.

## Вычислительные блоки

GPU предназначен для параллельной обработки данных, что достигается благодаря архитектуре, состоящей из множества вычислительных блоков.

1. **CUDA-ядра (NVIDIA) или потоковые процессоры (AMD).**  
    Эти элементы выполняют простейшие математические операции. Их количество определяет производительность GPU. Например, у флагманской NVIDIA RTX 4090 насчитывается 16 384 CUDA-ядра, что позволяет выполнять миллиарды операций в секунду.
2. **Тензорные ядра.**  
    Тензорные ядра — это специализированные модули, используемые для выполнения операций с матрицами. Они оптимизированы для работы с задачами машинного обучения, включая обучение нейронных сетей. Например, они ускоряют вычисления в формате FP16 и INT8, что уменьшает затраты ресурсов без потери точности.
3. **Ядра RT (Ray Tracing).**  
    Ядра RT — это модули, предназначенные для ускорения трассировки лучей. Они анализируют траектории света в сцене, рассчитывают взаимодействие лучей с поверхностями и создают реалистичное освещение, тени и отражения.
4. **Шейдерные модули.**  
    Каждый потоковый мультипроцессор включает шейдерные модули, которые выполняют задачи, связанные с обработкой текстур, расчётом освещения и других визуальных эффектов.
5. **Управляющие блоки.**  
    Они распределяют задачи между ядрами и следят за их выполнением, обеспечивая эффективное использование ресурсов GPU.

## Память в архитектуре GPU

Подсистема памяти играет важную роль в архитектуре GPU, обеспечивая хранение и передачу данных для выполнения вычислений.

1. **Видеопамять (VRAM).**  
    Видеопамять — это глобальная память, к которой GPU получает доступ через контроллер. Она используется для хранения текстур, моделей, данных шейдеров и других элементов. Современные GPU используют типы памяти GDDR6 и GDDR6X, которые обеспечивают высокую пропускную способность (до 1 ТБ/с).
2. **Кэш.**  
    Для уменьшения задержек доступ к данным осуществляется через кэш. GPU оснащены кэшами L1 и L2, которые хранят часто используемые данные. Это ускоряет выполнение операций, поскольку кэш быстрее глобальной памяти.
3. **Локальная.**  
    Каждый потоковый мультипроцессор имеет собственную локальную память, которая используется для временного хранения данных. Это позволяет избежать конфликтов при доступе к общей памяти и повышает производительность.
4. **Контроллер памяти.**  
    Он управляет обменом данными между GPU и видеопамятью. Современные контроллеры памяти работают с несколькими каналами, что увеличивает пропускную способность и позволяет обрабатывать большие объёмы данных.

|**Тип памяти**|**Функция**|**Пример применения**|
|---|---|---|
|Видеопамять (VRAM)|Хранит текстуры, модели, шейдеры и данные рендеринга|Обработка текстур в играх и 3D-моделировании|
|Кэш L1 и L2|Хранит часто используемые данные для быстрого доступа|Ускорение выполнения повторяющихся операций|
|Локальная|Используется каждым потоковым мультипроцессором для временного хранения данных|Выполнение параллельных вычислений|