

# ТЕОРИЯ
## LPIC 101.1.Работа с железом в Linux. Часть первая - sysfs, devfs, udev

##### Термины:
HAL(Hardware Abstraction Layer, «Слой аппаратных абстракций») - предоставляет абстракцию железа для ОС. HAL сам выбирает драйверы для общения с железом, чтобы ядру было легко работать с различными оборудованиями, без изменений в самом ядре. В наше время HAL не используется 
Dbus - предоставляет информацию о железе софту. Позволяет процессам обмениваться между собой. 
Udev - современный менеджер устройств

Преимущества udev:
- работает на уровне пользователя
- управление событиями аппаратной части(например, выдергивание флешки из ПК)
- понятные файлы конфигов
- в системе только  файлы **активных устройств**
- сохраняет имена устройств при переподключении

Devfs - использовавшаяся в прошлом виртуальная файловая система, функционал которой перешел в udev. Монтируется в /dev. Вся информация, которая есть у нас в данном случае в каталоге dev, ее нет на самом деле на жестком диске, она вся находится в оперативке. Она сама создавала содержимое каталога dev - devices. Но теперь эти действия выполняет udev. devfs содержит те файлы, при помощи которых можно обращаться непосредственно к устройствам

- mem - образ физической памяти в ПК, слепок состояния
- null - пустое устройство, в него происходит всегда запись вне зависимости от объема записанной информации. Он всегда возвращает успех. Обычно использовался как мусорка - если есть ошибки программы, отправляли все сюда и оно исчезало. Также, чтобы не получать предупреждения о запуске, приветственное сообщение
- pts/ - псевдотерминалы, программная реализация
- urandom - генератор случайных чисел, использовались для создания ключа шифрования
- sd(x) - блочные устройства, жесткие диски, накопители. Ниже видим, что есть диски sda1,sda2,sda - отдельные устройства
- tty - аппаратные терминалы


![0x0](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-07.10.2025-13_10.png)

Сетевые карты, видеокарты не отображаются, так как работают с пакетами, а не с байтами

Sysfs - экспортирует информацию о драйверах и устройствах на уровень пользователя от  ядра. Монтируется в /sys. Также находится в udev, она так активно не используется. В прошлом HAL хранил здесь БД об устройствах. То есть sysfs хранит информацию об устройствах. 

- devices/ - все устройства, зарегистрированные в ядре
- bus/ - перечень шин
- drivers/ - драйверы
- block/ - каталог блочных устройств. Блочные устройства чаще всего носители информации. Здесь появится устройство, если есть и само устройство и драйвер к нему
- class/ - группировка устройств по классам
![|699x35](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-07.10.2025-14_10-1.png)

Procfs - иерархическое представление всех процессов в системе. Монтируется в /proc.

- PID/ - информация о конкретном процессе 
- cpuinfo/ - сведения о ЦПУ
- devices/ - перечень настроенных устройств
- mounts/ - смонтированные файловые системы
- sys/ - доступная для редактирования информация о системе. Но после перезагрузки ОС отредактированная информация меняется на изначальную информацию
![|700x228](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-07.10.2025-14_10-2.png)

![|700x266](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-07.10.2025-14_10-3.png)


## LPIC 101.1 Работа с железом в Linux. Часть вторая - управление устройствами

##### Вывод списка оборудования:
- lsmod - информация о модулях ядра. Модуль ядра - объект, который расширяет  возможности ядра(драйверы и не только)
![|633x123](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-07.10.2025-14_10-4.png)
- lspci - информация об устройствах PCI
![|630x154](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-07.10.2025-14_10-5.png)
- lspcmcia - информация об устройствах PCMCIA, для ноутбуков
- lsusb - информация о шине USB
![|637x65](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-07.10.2025-14_10-6.png)
- lshal - база устройств HAL, сейчас команда недоступна
- lshw - детальная информация о комплектующих, сейчас команда недоступна 

##### Некоторые опции инструмента udev:
Перед началом команд пишем **"udevadm"**
- info - получение информации из БД
- trigger - запросить события для устройства
- settle - дождаться завершения обработки
- control - управление демоном
- monitor - следить за событиями(отключение флешки из системы, например)
- test - симулировать запуск события

##### Управление модулями ядра:
- lsmod - информация о модулях ядра
- modinfo (модуль) - информация о конкретном модуле
- rmmod (модуль) - удаление модуля ядра
- insmod (модуль) - установка модуля ядра
- modprobe (модуль) - деликатное удаление или добавление модулей, включая зависимости

# ПРАКТИКА

### Начну задания выполнять с ДЗ Семаева:
![|700x158](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-00_10.png)

1)Для поиска информации о процессоре, использую команду с видео самого Семаева, а именно - ***lscpu***
![|700x393](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-00_10-2.png)

2)Для определения модели жесткого диска использую команду - udevadm info со флажками -a -p и укажу путь - ***udevadm info -a -p class/block/sda1*** 
![700x357](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-00_10-1.png)

![500x34](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-00_10-3.png)

3)Чтобы вывести сведения обо всех платах расширения PCIEx - использовал команду ***lspci***
![|666x527](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-00_10-4.png)

4)Чтобы отключить звуковую карту для начала отключил все зависимости самого модуля, а потом и модуль, все делалось с помощью команды ***rmmod***

![|668x250](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-01_10.png)

Итог:

![|500x633](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-01_10-1.png)

5)Контроллер USB вырубал также, как и звуковую карту


![|673x275](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-01_10-2.png)

### Выполнения заданий с ald.pro:

#### Модуль 8. Управление пользователями и группами:

Задание 1.
1. Создал пользователя с помощью команды c домашним каталогом и оболочкой /bin/bash:
```
useradd user1 -s /bin/bash -m
```
![|675x421](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-13_10.png)

2. Назначил пароли пользователям:
```
passwd user1
passwd user2
```
![|678x423](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-13_10-1.png)

3. Назначил для каждого пользователя минимальный срок действия пароля 1 день, максимальный срок действия пароля 30 дней, время предупреждения об истечении пароля 3 дня, период неактивности 3 дня.
```
chage -m 1 -M 30 -W 3 -I 3 user1
chage -m 1 -M 30 -W 3 -I 3 user2
```
![|683x426](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-14_10.png)
Задание 2. 
1. Создал 3 группы, назначил пароль группе group3 и админом сделал user1, добавил пользователей в группы
```
groupadd group1
groupadd group2
groupadd group3
gpasswd group3
gpasswd -A user1 group3
usermod -aG group1,group2,group3 user1
usermod -aG group1,group2,group3 user2
```
![|700x437](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-14_10-1.png)
2.  Вошел под пользователем user2
![|700x437](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-14_10-2.png)
3. Получил права группы group3. Проверил, что user2 состоит в группе group3:
```
user2:newqrp group3
user2:groups
```
![|699x436](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-14_10-3.png)
4.  Переключился на user1 и включил user2 в группу group3:
```
user1: gpasswd -a user2 group3
```
![|700x438](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-14_10-4.png)

Задание 3. 
1. Заблокировал пользователя 2 и проверил это:
```
passwd -l user2
passwd -s user2
```
![|700x437](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-14_10-5.png)
2. Заставил пользователя user1 сменить свой пароль:
```
chage -d 0 user1
chage -l user1
```
![|700x437](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-14_10-6.png)
3. Поменял пароль на user1:
```
passwd user1
```
![|700x437](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-14_10-7.png)
4. Сменил имя пользователя user2 на user3:
```
usermod -l user3 user2
```
![|700x437](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-15_10.png)
5. Разблокировал пользователя:
![0x0](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-15_10-1.png)
6. Создал /mnt/home и перенес домашние каталоги, проверил:
```
mkdir /mnt/home
usermod -m -d /mnt/home/user1 user1
usermod -m -d /mnt/home/user3 user3
ls -la /mnt/home
```


Задание 4.
1. Посмотрел журналы удачных и неудачных входов пользователей user1, user3:
```
last user1
last user3
lastb user1
lastb user3
```
![|700x438](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-15_10-3.png)
2. Удалил группы и пользователей:
```
groupdel group1
groupdel group2
groupdel group3
userdel user1
userdel user3
```
![|700x439](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-15_10-4.png)
#### Модуль 10. Система аутентификации PAM и управление правами SUDO

Задание 1.
1. Используя команду sudo, изменил пароль суперпользователя (root):
```
passwd root
```
![|0x0](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-15_10-5.png)
Задание 2.
1. Создал пользователей john, user1, user2 и задал пароли для пользователей user1, user2:
![|684x427](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-16_10-1.png)
2. Создал файл правил 01_usermanagement и добавил пользователю john права использования `sudo` без ввода пароля для команд `groupadd` и `usermod`:
![|689x430](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-16_10.png)

Задание 3. 
1.  Переключился в  пользователя john, создал группу g_admin и добавьте в нее пользователей user1 и user2:
```
sudo su - john
groupadd g_admin
usermod -aG g_admin user1
usermod -aG g_admin user3
```
![|687x429](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-16_10-2.png)
2. Отредактировал файл `/etc/pam.d/su` и добавил ограничение, чтобы только пользователи из группы «g_admin» могли использовать команду `su`.Проверил:
```
nano /etc/pam.d/su
```
![|687x430](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-16_10-3.png)

![|690x428](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-16_10-4.png)
Задача 4
1.  Настроил модуль pam_tally для отслеживания неудачных попыток входа в систему и установил: правило блокировки учетной записи на 5 минут после 3 неудачных попыток входа:
```
nano /etc/par.d/common-auth
pam_tally.so per_user deny=3 unlock_time=300
```
![|688x429](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-16_10-5.png)

#### Модуль 20. Сеть и стек TCP/IP, управление сетевыми интерфейсами

Задание 1.
1. Вывел список всех сетевых интерфейсов на компьютере и их текущее состояние (активный/неактивный):
```
ip link show
ip a
```
w
2. Вывел только IPv4 адрес каждого интерфейса:
```
ip -4 address show
```
![|0x0](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-23_10-1.png)
3. Вывел таблицу ARP (Address Resolution Protocol) для конкретного сетевого интерфейса eth0:
```
ip neigh show dev ens33
```
![|0x0](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-23_10-2.png)
4. Выполните трассировку маршрута к ya.ru, используя ICMP-пакеты, с ограничением количества запросов до 1:
```
traceroute ya.ru -I -q 1
```
![|0x0](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-23_10-3.png)
5. Вывел список всех открытых портов:
```
ss -tlp
```
![|700x437](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-23_10-4.png)

Задание 2.
1. Просмотрел текущие DNS-настройки, используя утилиту nmtui, добавил дополнительный DNS-сервер 1.1.1.1, проверил корректность работы новых DNS-настроек путем разрешения имен хостов в IP-адреса:
![|700x437](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-23_10-5.png)
![|700x442](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-23_10-7.png)
![|700x437](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-23_10-6.png)

Задание 3.
Дан IP-адрес хоста в сети 192.168.0.128/28, поэтому $$
(32 - 28)^2 = 4^2;
4^2 = 16$$ - первый и последние адреса зарезервированы для адреса сети и широковещательного домена, поэтому у нас есть 14 хостов в сети
192.168.0.128+14 = 192.168.0.142 - это последний адрес в нашей сети

Задание 4. 
1. Создал новый сетевой интерфейс
![|691x433](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-23_10-8.png)

2. Сконфигурировал IP-адрес и маску подсети:
![|695x435](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-23_10-9.png)
3. Убедился, что новые настройки применены успешно, используя команду nmcli
![|700x438](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-08.10.2025-23_10-10.png)

#### Модуль 19. Файловая система в Linux, работа с блочными устройствами и LVM

Задание 1. 
1. Добавил к существующей виртуальной машине новый жесткий диск, проверил:
![|700x393](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-09.10.2025-20_10-1.png)
![|700x393](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-09.10.2025-20_10-2.png)

2. Установил метку диска msdos утилитой parted в режиме командной строки и создал на подключенном жестком диске 2 раздела  утилитой parted в режиме командной строки
```
parted /dev/sda mklabel msdos
parted /dev/sda mkpart primary xMB x+100MiB
parted /dev/sda mkpart primary yMB y+100MB
```
![|700x393](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-09.10.2025-20_10-3.png)

![|700x393](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-09.10.2025-21_10.png)
3. Создаk на новых разделах файловые системы EXT3 и XFS и смонтировал их в каталоги /mnt/part1 и /mnt/part2:
```
mkfs.ext3 dev/sda1
apt-get install xfsprogs
mkfs.xfs dev/sda2
mkdir /mnt/part1
mkdir /mnt/part2
mount /dev/sda2 /mnt/part2
mount /dev/sda1 /mnt/part1
```
![|700x393](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-09.10.2025-21_10-1.png)

![|700x393](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-09.10.2025-21_10-2.png)

![|700x393](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-09.10.2025-21_10-3.png)

![|700x393](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-09.10.2025-21_10-5.png)

4. Создал  постоянное монтирование для указанных разделов, проверил настройки:
```
nano /etc/fstab
/dev/sda1   /mnt/part1   ext3   defaults,ro   0 0
/dev/sda2   /mnt/part2   xfs   defaults,noexec   0 0
cat /proc/mounts | grep /mnt/part
```
![|700x393](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-09.10.2025-21_10-6.png)

![|700x393](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-09.10.2025-21_10-8.png)
5. Удалил созданные точки монтирования и разделы:
```
umount /mnt/part1
umount /mnt/part2
rmdir /mnt/part1
rmdir /mnt/part2
parted /dev/sda rm 1
parted /dev/sda rm 2
```
![|700x393](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-09.10.2025-21_10-9.png)

Задание 2. 
1. Создал раздел, создал LVM PV, LVM VG, LVM LV, создал файловую систему ext4:
```
pvcreate /dev/sda1
vgcreate test /dev/sda1
lvcreate -l 100%FREE -n test test
mkfs.ext4 /dev/test/test
```
![|700x393](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-09.10.2025-21_10-12.png)

2. Создал еще один раздел, выполнил процедуру расширения имеющегося LVM раздел на размер /dev/sda2 с расширением файловой системы, проверил:
```
pvcreate /dev/sda2
vgextend test /dev/sda2
lvextend -l +100%FREE /dev/test/test
resize2fs /dev/test/test
pvs
vgs
lvs
df -h
```
![|700x393](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-09.10.2025-21_10-13.png)

![|700x393](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-09.10.2025-21_10-14.png)
3. Удалил созданные разделы, проверил:
```
lvremove /dev/test/test
vgremove test
pvremove /dev/sda1
pvremove /dev/sda2
parted /dev/sda rm 1
parted /dev/sda rm 2
```

![|700x393](OC.%20Базовое%20устройство%20OC%20и%20введение%20в%20Linux-09.10.2025-22_10.png)
